<!DOCTYPE html>
<html>
<head>
    <title>Technical Blog Monitor</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 { color: #333; }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #2563eb;
        }
        .stat-label {
            color: #666;
            margin-top: 5px;
        }
        .posts-list {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .post-item {
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }
        .post-item:last-child {
            border-bottom: none;
        }
        .post-title {
            font-size: 1.1em;
            color: #2563eb;
            text-decoration: none;
            font-weight: 500;
        }
        .post-meta {
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }
        .nav {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e5e5e5;
        }
        .nav a {
            color: #666;
            text-decoration: none;
            font-weight: 500;
        }
        .nav a:hover {
            color: #2563eb;
        }
    </style>
</head>
<body>
    <h1>ðŸ“š Technical Blog Monitor Dashboard</h1>
    
    <div class="nav">
        <a href="/">Dashboard</a>
        <a href="/api/stats">API Stats</a>
        <a href="/api/posts">API Posts</a>
        <a href="/health">Health Check</a>
    </div>
    
    <div class="stats">
        <div class="stat-card">
            <div class="stat-number" id="total-posts">0</div>
            <div class="stat-label">Total Posts</div>
        </div>
        <div class="stat-card">
            <div class="stat-number" id="posts-today">0</div>
            <div class="stat-label">Posts Today</div>
        </div>
        <div class="stat-card">
            <div class="stat-number" id="posts-week">0</div>
            <div class="stat-label">Posts This Week</div>
        </div>
        <div class="stat-card">
            <div class="stat-number" id="sources">0</div>
            <div class="stat-label">Active Sources</div>
        </div>
    </div>
    
    <div class="posts-list">
        <h2>Recent Posts</h2>
        <div id="posts-container">
            <p>Loading posts...</p>
        </div>
    </div>
    
    <script>
        async function loadDashboard() {
            try {
                // Load stats
                const statsResponse = await fetch('/api/stats');
                const stats = await statsResponse.json();
                
                document.getElementById('total-posts').textContent = stats.total_posts;
                document.getElementById('posts-today').textContent = stats.posts_today;
                document.getElementById('posts-week').textContent = stats.posts_week;
                document.getElementById('sources').textContent = stats.sources.length;
                
                // Load recent posts
                const postsResponse = await fetch('/api/posts?per_page=10');
                const postsData = await postsResponse.json();
                
                const container = document.getElementById('posts-container');
                if (postsData.posts.length === 0) {
                    container.innerHTML = '<p>No posts found. Run the monitor to discover posts!</p>';
                } else {
                    container.innerHTML = postsData.posts.map(post => `
                        <div class="post-item">
                            <a href="${post.url}" target="_blank" class="post-title">${post.title}</a>
                            <div class="post-meta">
                                ${post.source} â€¢ ${post.author || 'Unknown Author'} â€¢ 
                                ${post.publish_date ? new Date(post.publish_date).toLocaleDateString() : 'No date'}
                            </div>
                            ${post.summary ? `<div style="margin-top: 10px; color: #666;">${post.summary.substring(0, 200)}...</div>` : ''}
                        </div>
                    `).join('');
                }
            } catch (error) {
                console.error('Error loading dashboard:', error);
                document.getElementById('posts-container').innerHTML = 
                    '<p style="color: red;">Error loading posts. Check console for details.</p>';
            }
        }
        
        // Load dashboard on page load
        loadDashboard();
        
        // Refresh every 30 seconds
        setInterval(loadDashboard, 30000);
    </script>
</body>
</html>