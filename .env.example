# Technical Blog Monitor - Environment Configuration
# This file contains all available configuration options for the blog monitor
# Copy this file to .env and adjust the values as needed

#######################
# Application Settings
#######################
# Application name and environment
APP_NAME=technical-blog-monitor
VERSION=0.1.0
ENVIRONMENT=development  # development, staging, production
DEBUG=false

# Base paths for data storage
BASE_DIR=.
DATA_DIR=./data

#######################
# Feed Configuration
#######################
# Example feed configuration (you can add multiple feeds)
# Format: FEEDS__0__name=feed_name, FEEDS__0__url=https://example.com/feed
# For multiple feeds, increment the index: FEEDS__1__name, FEEDS__2__name,
# Feeds
FEEDS__0__NAME=AWS Blog
FEEDS__0__URL=https://aws.amazon.com/blogs/aws/feed/
FEEDS__0__CHECK_INTERVAL_MINUTES=60
FEEDS__0__MAX_POSTS_PER_CHECK=3
FEEDS__0__ENABLED=true

FEEDS__1__NAME=Microsoft Azure Blog
FEEDS__1__URL=https://azure.microsoft.com/en-us/blog/feed/
FEEDS__1__CHECK_INTERVAL_MINUTES=60
FEEDS__1__MAX_POSTS_PER_CHECK=3
FEEDS__1__ENABLED=true

FEEDS__2__NAME=Microsoft Azure Blog
FEEDS__2__URL=https://techcommunity.microsoft.com/t5/azure-blog/bg-p/AzureBlog/rss
FEEDS__2__CHECK_INTERVAL_MINUTES=60
FEEDS__2__MAX_POSTS_PER_CHECK=10
FEEDS__2__ENABLED=true

# Optional URL to fetch feed list dynamically
# FEED_LIST_URL=https://example.com/feeds.json

#######################
# Browser Configuration
#######################
# Headless browser settings for rendering pages
BROWSER__HEADLESS=true
BROWSER__BROWSER_TYPE=chromium  # chromium, firefox, webkit
BROWSER__TIMEOUT_SECONDS=30
BROWSER__VIEWPORT_WIDTH=1280
BROWSER__VIEWPORT_HEIGHT=800
BROWSER__USER_AGENT=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36
BROWSER__WAIT_UNTIL=networkidle  # load, domcontentloaded, networkidle
BROWSER__SCREENSHOT_FULL_PAGE=false
BROWSER__SCREENSHOT_FORMAT=png  # png, jpeg
BROWSER__MAX_CONCURRENT_BROWSERS=5
BROWSER__DISABLE_JAVASCRIPT=false
BROWSER__BLOCK_ADS=true
BROWSER__STEALTH_MODE=true

#######################
# Cache Configuration
#######################
# Caching settings for improved performance
# Default: Unified PostgreSQL storage (cache + vector DB in one database)
CACHE__ENABLED=true
# Cache backend: memory, filesystem, postgres
# Using "postgres" enables unified storage with pgvector (single database, recommended)
CACHE__BACKEND=postgres  # postgres, memory, filesystem
# PostgreSQL DSN for cache (shared with vector DB for unified storage)
CACHE__POSTGRES_DSN=postgresql://localhost:5432/blogmon
CACHE__CACHE_TTL_HOURS=168  # 1 week
CACHE__LOCAL_STORAGE_PATH=./cache

#######################
# Embedding Configuration
#######################
# Text and image embedding model settings
EMBEDDING__TEXT_MODEL_TYPE=ollama  # openai, huggingface, sentence_transformers, ollama, custom
EMBEDDING__TEXT_MODEL_NAME=hf.co/JonathanMiddleton/Qwen3-Embedding-8B-GGUF:BF16
EMBEDDING__IMAGE_MODEL_TYPE=  # Leave empty to disable image embeddings
EMBEDDING__IMAGE_MODEL_NAME=

# API credentials (required for respective services)
# EMBEDDING__OPENAI_API_KEY=sk-your-openai-api-key
# EMBEDDING__HUGGINGFACE_API_KEY=your-huggingface-api-key

# Model parameters
# For MRL (Matryoshka Representation Learning) truncation: set to desired dimension
# Full Qwen3-8B outputs 4096 dims, but can be truncated via MRL to 1920, 1536, 1024, etc.
EMBEDDING__EMBEDDING_DIMENSIONS=1920  # MRL allows truncation to reduce storage
EMBEDDING__BATCH_SIZE=8
EMBEDDING__MAX_RETRIES=3
EMBEDDING__TIMEOUT_SECONDS=30

# Local model settings (for sentence_transformers or custom)
# EMBEDDING__LOCAL_MODEL_PATH=./models/all-MiniLM-L6-v2
EMBEDDING__USE_GPU=false

#######################
# Vector DB Configuration
#######################
# Vector database settings for storing embeddings
# Default: pgvector with unified PostgreSQL storage (same database as cache)
VECTOR_DB__DB_TYPE=pgvector  # pgvector, qdrant, chroma, pinecone, milvus, weaviate
VECTOR_DB__CONNECTION_STRING=postgresql://localhost:5432/blogmon
# VECTOR_DB__API_KEY=your-vector-db-api-key
VECTOR_DB__COLLECTION_NAME=technical_blog_posts

# Schema configuration
# IMPORTANT: VECTOR_DB__TEXT_VECTOR_DIMENSION must match EMBEDDING__EMBEDDING_DIMENSIONS
# pgvector has a hard limit of 2000 dimensions, so use MRL truncation for larger models
VECTOR_DB__TEXT_VECTOR_DIMENSION=1920  # Should match EMBEDDING__EMBEDDING_DIMENSIONS
VECTOR_DB__IMAGE_VECTOR_DIMENSION=512  # For image embeddings if used
VECTOR_DB__DISTANCE_METRIC=cosine  # cosine, euclidean, dot

# Performance settings
VECTOR_DB__BATCH_SIZE=100
VECTOR_DB__TIMEOUT_SECONDS=30

#######################
# LLM Configuration
#######################
# LLM settings for article summarization
LLM__PROVIDER=ollama  # openai, ollama, custom
LLM__MODEL_NAME=hf.co/unsloth/Olmo-3-7B-Instruct-GGUF:BF16
# LLM__API_KEY=your-openai-api-key  # Only required for OpenAI provider
# LLM__BASE_URL=http://localhost:11434  # Ollama endpoint (uses default if omitted)
LLM__TIMEOUT_SECONDS=300  # Increase for slower local models
LLM__TEMPERATURE=0.7
LLM__MAX_TOKENS=1024

#######################
# Article Processing
#######################
# Controls how articles are processed after discovery
ARTICLE_PROCESSING__FULL_CONTENT_CAPTURE=true  # Visit URL and render full content
ARTICLE_PROCESSING__GENERATE_SUMMARY=true  # Use LLM to generate article summaries
ARTICLE_PROCESSING__ARCHIVE_HTML=true  # Store cleaned HTML for archival
ARTICLE_PROCESSING__ARCHIVE_SCREENSHOTS=false  # Store Playwright screenshots (uses disk space)
ARTICLE_PROCESSING__MAX_ARTICLES_PER_FEED=50  # Safety valve to prevent runaway processing
ARTICLE_PROCESSING__CONCURRENT_ARTICLE_TASKS=5  # Parallel processing limit
ARTICLE_PROCESSING__SUMMARY_MAX_TOKENS=256  # Max tokens for LLM-generated summaries

#######################
# Scheduler Configuration
#######################
# Job scheduler settings
SCHEDULER__JOB_STORE_TYPE=memory  # memory, sqlalchemy
SCHEDULER__MAX_INSTANCES=1
SCHEDULER__TIMEZONE=UTC
SCHEDULER__COALESCE=true
SCHEDULER__MISFIRE_GRACE_TIME=60  # seconds

#######################
# Metrics Configuration
#######################
# Monitoring and logging settings
METRICS__ENABLED=true
METRICS__PROMETHEUS_ENABLED=false
METRICS__PROMETHEUS_PORT=8000
METRICS__LOG_METRICS=true
METRICS__LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
METRICS__STRUCTURED_LOGGING=true

#######################
# Runtime Settings
#######################
# General performance and behavior settings
MAX_CONCURRENT_TASKS=10
REQUEST_TIMEOUT_SECONDS=30
BACKOFF_MAX_RETRIES=5
BACKOFF_MAX_TIME=60  # seconds
